"use strict";exports.id=7317,exports.ids=[7317],exports.modules={7317:(e,a,i)=>{i.d(a,{ImageDrawer:()=>s});var t=i(1146);class s{constructor(e){this.loadImageShape=async e=>{if(!this._engine.loadImage)throw Error(`${t.gK} image shape not initialized`);await this._engine.loadImage({gif:e.gif,name:e.name,replaceColor:e.replaceColor??!1,src:e.src})},this._engine=e}addImage(e){this._engine.images||(this._engine.images=[]),this._engine.images.push(e)}async draw(e){let{context:a,radius:t,particle:s,opacity:l}=e,n=s.image,o=n?.element;if(n){if(a.globalAlpha=l,n.gif&&n.gifData){let{drawGif:a}=await i.e(1853).then(i.bind(i,1853));a(e)}else if(o){let e=n.ratio,i={x:-t,y:-t},s=2*t;a.drawImage(o,i.x,i.y,s,s/e)}a.globalAlpha=1}}getSidesCount(){return 12}async init(e){let a=e.actualOptions;if(a.preload&&this._engine.loadImage)for(let e of a.preload)await this._engine.loadImage(e)}async loadShape(e){if("image"!==e.shape&&"images"!==e.shape)return;this._engine.images||(this._engine.images=[]);let a=e.shapeData;a&&(this._engine.images.find(e=>e.name===a.name||e.source===a.src)||(await this.loadImageShape(a),await this.loadShape(e)))}async particleInit(e,a){let t;if("image"!==a.shape&&"images"!==a.shape)return;this._engine.images||(this._engine.images=[]);let s=this._engine.images,l=a.shapeData;if(!l)return;let n=a.getFillColor(),o=s.find(e=>e.name===l.name||e.source===l.src);if(!o)return;let g=l.replaceColor??o.replaceColor;if(o.loading){setTimeout(()=>{this.particleInit(e,a)});return}if(o.svgData&&n){let{replaceImageColor:e}=await Promise.resolve().then(i.bind(i,2350));t=await e(o,l,n,a)}else t={color:n,data:o,element:o.element,gif:o.gif,gifData:o.gifData,gifLoopCount:o.gifLoopCount,loaded:!0,ratio:l.width&&l.height?l.width/l.height:o.ratio??1,replaceColor:g,source:l.src};t.ratio||(t.ratio=1);let r={image:t,fill:l.fill??a.shapeFill,close:l.close??a.shapeClose};a.image=r.image,a.shapeFill=r.fill,a.shapeClose=r.close}}}};